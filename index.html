<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>USB Drive Authenticator</title>
  </head>
  <body>
    <h1>USB Drive Authenticator</h1>
    <select id="usbDriveSelect"></select>
    <button id="authenticateBtn" disabled>Authenticate</button>
    <p id="result"></p>
    <script>
      const validKeys = ['ABC123', 'DEF456', 'GHI789']; // Replace with your valid serial number keys

      const usbDriveSelect = document.getElementById('usbDriveSelect');
      const authenticateBtn = document.getElementById('authenticateBtn');
      const resultEl = document.getElementById('result');

      async function populateUSBDrives() {
        const connectedDrives = await window.api.getConnectedUSBDrives();
        usbDriveSelect.innerHTML = connectedDrives.map(drive => `<option value="${drive.path}">${drive.path}</option>`).join('');
        authenticateBtn.disabled = connectedDrives.length === 0;
      }

      populateUSBDrives();

      authenticateBtn.addEventListener('click', async () => {
        const selectedDrivePath = usbDriveSelect.value;
        const serialNumber = await window.api.getSerialNumber(selectedDrivePath);
        const isValid = await window.api.validateSerialNumber(serialNumber, validKeys);
        if (isValid) {
          resultEl.textContent = 'Authentication successful!';
        } else {
          resultEl.textContent = 'Invalid serial number.';
        }
      });
    </script>
  </body>
</html>